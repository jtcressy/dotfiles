# Fish shell configuration

# Environment variables
set -gx COLORTERM truecolor

# PATH
fish_add_path $HOME/.krew/bin
fish_add_path $HOME/go/bin
fish_add_path $HOME/bin
fish_add_path $HOME/.local/bin
fish_add_path /usr/local/sbin
fish_add_path $HOME/.rd/bin
{{ if eq .chezmoi.os "linux" -}}
fish_add_path $HOME/workspace/nvidia/arbor/bin
{{ end -}}

# Kubeconfig management
if type -q konf-go
    konf-go shellwrapper fish | source
    konf --silent set -
else
    set -gx KUBECONFIG $HOME/.kube/config
end

# SSH agent
{{ if eq .chezmoi.os "darwin" -}}
# SSH agent via keychain (macOS)
if type -q keychain
    keychain --eval --noinherit -q | source
end
{{ else -}}
set -gx SSH_AUTH_SOCK $HOME/.1password/agent.sock
{{ end -}}

# GPG
set -gx GPG_TTY (tty)

# Codespaces editor
if set -q CODESPACES; and test "$CODESPACES" != "false"
    set -gx EDITOR "code --wait"
end

# Tool integrations (only if available)
if type -q starship
    starship init fish | source
end

if type -q zoxide
    zoxide init fish | source
end

if type -q fzf
    fzf --fish | source
end

if type -q thefuck
    thefuck --alias | source
end

if type -q bat
    alias cat "bat --theme-dark=gruvbox-dark --theme-light=gruvbox-light"
end
